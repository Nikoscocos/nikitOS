<html>
    <style>
        html, body {
            width: 100%;
            height: 100%;
        }
        body {
            margin: 0px;
        }
        #output {
            width: 100%;
            height: 100%;
            margin-bottom: -4px;
        }
    </style>
    <body>
        <canvas id="output" width="256" height="240"></canvas>

        <script src="zip.js"></script>
        <script src="inflate.js"></script>

        <script src="mappers.js"></script>
        <script src="nrom.js"></script>
        <script src="mmc1.js"></script>
        <script src="uxrom.js"></script>
        <script src="cnrom.js"></script>
        <script src="mmc3.js"></script>
        <script src="axrom.js"></script>

        <script src="cpu.js"></script>
        <script src="pipu.js"></script>
        <script src="apu.js"></script>
        <script src="nes.js"></script>

        <script src="nesaudio.js"></script>
        <script src="nesjs.js"></script>

        <script src="/system/lib/simpleIDB.js"></script>
        <script src="/system/lib/webfs.js"></script>

        <script>
            function log(text) {}
            window.onload = async function() {
                const queryString = window.location.search;
                const urlParams = new URLSearchParams(queryString);
                const path = urlParams.get('path');

                file = await webfs.getFile(path);
                base64 = file.contents;

                fetch(base64)
                .then(response => {
                    if (!response.ok) {
                        throw new Error(response.status);
                    }
                    return response.arrayBuffer();
                })
                .then(buf => {
                    let arr = new Uint8Array(buf);
                    loadRom(arr, name);
                })
            }
        </script>
    </body>
</html>